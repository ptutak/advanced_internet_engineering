{% extends 'base.html' %}
{% block content %}
{% if g["role"] == "admin" %}
<ul class="list-group">
    <li class="list-group-item">
        <form method="post" enctype="multipart/form-data">
            <div class="form-group">
                <label for="name">Product name:</label>
                <input type="text" name="name" id="name" class="form-control" required>
                <label for="price">Price:</label>
                <input type="text" name="price" id="price" class="form-control" required>
                <label for="image">Image:</label>
                <input type="file" name="image" id="image" class="form-control">
                <label for="category">Category:</label>
                <select class="form-control" name="id_category" default="1" required>
                    {% for category in categories %}
                    <option value="{{ category['id'] }}">{{ category["name"] }}</option>
                    {% endfor %}
                </select>
                <input type="submit" value="Add" class="btn btn-primary">
            </div>
        </form>
    </li>
</ul>
{% endif %}
<table class="table table-borderless">
    <tbody>
        <tr style="height: 500px;">
        {% for product in products %}
            {% if loop.index % 4 == 0 %}
        </tr>
        <tr style="height: 500px;">
            {% endif %}
                <td style="width: 30%;">
                    <ul class="list-group">
                        <li class="list-group-item">
                            {{ product["name"] }}
                        </li>
                        {% if product["image"] %}
                        <li class="list-group-item">
                            <img src="{{ url_for('static', filename=product['image']) }}" style="max-width: 400px; max-height: 400px;" class="img-thumbnail px-auto">
                        </li>
                        {% else %}
                        <li class="list-group-item">
                            <img src="{{ url_for('static', filename='no_image.png') }}" style="max-width: 400px; max-height: 400px;" class="img-thumbnail px-auto">
                        </li>
                        {% endif %}
                        <li class="list-group-item">
                            {{ product["price"] }} z≈Ç
                        </li>
                        {% if g["role"] == "admin" %}
                        <li class="list-group-item">
                            <button class="btn btn-primary" id="delete_button_{{ product['id'] }}">
                                Delete
                            </button>
                            <script>
                                $("#delete_button_{{ product['id'] }}").click(function(){
                                    $.ajax({
                                        url: '{{ url_for("schema_delete", schema="products", id_number=product["id"]) }}',
                                        type: 'DELETE',
                                        success: function(response) {
                                            location.reload()
                                        },
                                    })
                                })
                            </script>
                        </li>
                        {% endif %}
                    </ul>
                </td>
        {% endfor %}
        </tr>
    </tbody>
</table>
{% endblock %}
